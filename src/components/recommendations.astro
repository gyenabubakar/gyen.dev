---
import recommendations from '~/data/recommendations.json';
import { Image } from 'astro:assets';
import walulel from '~/assets/companies/walulel.png';
import distro from '~/assets/companies/distro.svg';
import distroLight from '~/assets/companies/distro-light.svg';
import lbm from '~/assets/companies/lbm.svg';
import specta from '~/assets/companies/specta.svg';

const imageMap = {
  'walulel.png': walulel,
  'distro.svg': distro,
  'distro-light.svg': distroLight,
  'lbm.svg': lbm,
  'specta.svg': specta,
};
---

<section class="mb-16">
  <h2 class="mb-8 text-2xl font-bold">What people say</h2>

  <div class="space-y-6">
    {
      recommendations.map((rec) => (
        <article class="border border-black p-6 hover:shadow-lg dark:border-white">
          <div class="mb-4 flex items-start gap-4">
            <img src={rec.image} alt={rec.name} class="size-12 rounded-full object-cover" />

            <div class="flex-1">
              <h3 class="text-xl font-medium">{rec.name}</h3>

              <div class="flex items-center gap-2 text-sm text-neutral-500 dark:text-neutral-400 [&>img]:size-5 [&>img]:object-contain">
                {rec.companyLogo && (
                  <>
                    {rec.companyLogoDark && imageMap[rec.companyLogoDark] ? (
                      <>
                        <Image
                          src={imageMap[rec.companyLogo]}
                          alt={rec.company}
                          aria-hidden="true"
                          class="dark:hidden"
                          width={20}
                          height={20}
                        />
                        <Image
                          src={imageMap[rec.companyLogoDark]}
                          alt={rec.company}
                          aria-hidden="true"
                          class="hidden dark:block"
                          width={20}
                          height={20}
                        />
                      </>
                    ) : imageMap[rec.companyLogo] ? (
                      <Image
                        src={imageMap[rec.companyLogo]}
                        alt={rec.company}
                        aria-hidden="true"
                        width={20}
                        height={20}
                      />
                    ) : (
                      <img
                        src={`/companies/${rec.companyLogo}`}
                        alt={rec.company}
                        aria-hidden="true"
                        width="20"
                        height="20"
                      />
                    )}
                  </>
                )}
                <span>{rec.title ? `${rec.title} Â· ${rec.company}` : rec.company}</span>
              </div>
            </div>
          </div>

          <p class="text-sm leading-relaxed whitespace-pre-line text-neutral-600 dark:text-neutral-400">
            {rec.text}
          </p>
        </article>
      ))
    }
  </div>
</section>
